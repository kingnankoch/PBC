C51 COMPILER V9.54   1_1                                                                   12/01/2021 01:49:53 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 1_1
OBJECT MODULE PLACED IN .\Objects\1-1.obj
COMPILER INVOKED BY: C:\Program Files\Keil_v5\C51\BIN\C51.EXE 1-1.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\
                    -Listings\1-1.lst) TABS(2) OBJECT(.\Objects\1-1.obj)

line level    source

   1          #include "reg51.h"
   2          
   3          // ADCæ§åˆ¶æ¥å£
   4          sbit start = P3^0;
   5          sbit eoc = P3^1;
   6          sbit oe= P3^2;
   7          
   8          
   9          // 1602æ§åˆ¶æ¥å£ 
  10          sbit RS = P3^3;
  11          sbit RW = P3^4;
  12          sbit E = P3^5;
  13          
  14          
  15          // // 1602æ§åˆ¶æ¥å£ 
  16          // sbit rs= P3^3;
  17          // sbit rw= P3^4;
  18          // sbit e= P3^5;
  19          
  20          // å®šä¸€ä¸ªå˜é‡å­˜å‚¨ä» P2 ä¸­è¯»å–çš„ç”µå‹å€¼
  21          unsigned int vol = 0;
  22          unsigned char numberArr[] = {"0123456789"};
  23          unsigned char str[] = {"VOLTAGE:"};
  24          
  25          // è¿™é‡Œæ²¡æ•´æ˜ç™½
  26          unsigned char temp0 = 0, temp1 = 0, temp2 = 0;
  27          
  28          // å»¶æ—¶å‡½æ•°
  29          void delay (unsigned int n)
  30          {
  31   1        unsigned int i=0,j=0;
  32   1        for (i = 0; i < n; i++)
  33   1        {
  34   2          for(j=0;j<120;j++);
  35   2        }
  36   1      }
  37          
  38          
  39          
  40          //  LCD star
  41          
  42          // å¯¹ ç”µå‹å€¼çš„æ˜¾ç¤º 1206çš„æ˜¾ç¤ºå± 
  43          
  44          
  45          
  46          // å†™å‘½ä»¤
  47          void wireCommand(unsigned char com) {
  48   1          RS = 0; // ä½ç”µå¹³å¼€å§‹å†™å‘½ä»¤   é«˜ç”µå¹³å†™æ•°æ®
  49   1          RW = 0; // ä½ç”µå¹³ä¸º å†™ï¼Œ é«˜ç”µå¹³ä¸ºè¯» 
  50   1          E = 0;  // ä½¿èƒ½ ç«¯ ä¸‹é™æ²¿æœ‰æ•ˆï¼›  æ ¹æ®æ—¶åºå›¾  åˆå§‹ä½ç”µå¹³ï¼Œç„¶åæ‹‰é«˜ç”µå¹³ å‰ æ”
             -¾å…¥ æ•°æ®
  51   1          P1 = com; // é€šè¿‡ P2å­˜å…¥æ•°æ®
  52   1          delay(5);
  53   1          E = 1; // æ‹‰é«˜ç”µå¹³ å¼€å§‹å†™å…¥æ•°æ®ï¼Œ ç„¶å  æ•°æ®ä¼ è¾“å®Œæˆ æ‹‰ä½
C51 COMPILER V9.54   1_1                                                                   12/01/2021 01:49:53 PAGE 2   

  54   1          E = 0; // æ‹‰ä½ç”µå¹³ æ•°æ®å†™å…¥å®Œæˆï¼Œ
  55   1      }
  56          
  57          // å†™æ•°æ®
  58          void wireData(unsigned char dat){
  59   1          RS = 1; // ä½ç”µå¹³å¼€å§‹å†™å‘½ä»¤   é«˜ç”µå¹³å†™æ•°æ®
  60   1          RW = 0; // ä½ç”µå¹³ä¸º å†™ï¼Œ é«˜ç”µå¹³ä¸ºè¯» 
  61   1          E = 0;  // ä½¿èƒ½ ç«¯ ä¸‹é™æ²¿æœ‰æ•ˆï¼›  æ ¹æ®æ—¶åºå›¾  åˆå§‹ä½ç”µå¹³ï¼Œç„¶åæ‹‰é«˜ç”µå¹³ å‰ æ”
             -¾å…¥ æ•°æ®
  62   1          P1 = dat;// é€šè¿‡ P2å­˜å…¥æ•°æ®
  63   1          delay(5);
  64   1          E = 1; // æ‹‰é«˜ç”µå¹³ å¼€å§‹å†™å…¥æ•°æ®ï¼Œ ç„¶å  æ•°æ®ä¼ è¾“å®Œæˆ æ‹‰ä½
  65   1          E = 0; // æ‹‰ä½ç”µå¹³ æ•°æ®å†™å…¥å®Œæˆï¼Œ
  66   1      }
  67          
  68          void initLcd(){
  69   1          // å†™å…¥å‘½ä»¤ 
  70   1          // 00111000  è®¾ç½®16 * 2æ˜¾ç¤ºï¼Œ 5*7ç‚¹é˜µï¼Œ 8ä½æ•°æ®æ¥å£
  71   1          wireCommand(0x38);
  72   1          // 0x0C  00001100 è®¾ç½®å¼€æ˜¾ç¤ºï¼Œ ä¸æ˜¾ç¤ºå…‰æ ‡
  73   1          wireCommand(0x0C);
  74   1          // å†™ä¸€ä¸ªå­—ç¬¦ååœ°å€æŒ‡é’ˆ åŠ ä¸€
  75   1          wireCommand(0x06);
  76   1          // æ˜¾ç¤ºæ¸…é›¶ æ•°æ®æŒ‡é’ˆæ¸…é›¶
  77   1          wireCommand(0x01);
  78   1      
  79   1      }
  80          
  81          int k = 0;
  82          void display(){
  83   1          // wireCommand(0x80);
  84   1          // delay(5);
  85   1          vol = (vol * 100) / 51;
  86   1          // vol = 210;
  87   1          temp0 = vol / 100;
  88   1          temp1 = (vol % 100) / 10;
  89   1          temp2 = vol % 10;
  90   1      
  91   1          wireCommand(0x80);
  92   1          
  93   1          for (k = 0;k <8; k++) {
  94   2              wireData(str[k]);
  95   2              delay(5);
  96   2          }
  97   1          wireCommand(0x80 + 0x40 + 2);
  98   1          delay(5);
  99   1          wireData('K');
 100   1          wireData(numberArr[temp0]);
 101   1          delay(5);
 102   1          // wireData(number[temp1]);
 103   1          // delay(5);
 104   1          // wireData(numberArr[vol]);
 105   1          delay(5);
 106   1          wireData('.');
 107   1          delay(5);
 108   1          wireData(numberArr[temp1]);
 109   1          delay(5);
 110   1          wireData(numberArr[temp0]);
 111   1          delay(5);
 112   1      }
 113          
 114          // LCD end
C51 COMPILER V9.54   1_1                                                                   12/01/2021 01:49:53 PAGE 3   

 115          
 116          
 117          void adc() {
 118   1          // æ ¹æ®æ—¶åºå›¾ é¦–å…ˆ startçš„çŠ¶æ€æ˜¯ å…³é—­ ä½ç”µå¹³ 
 119   1          start = 0;
 120   1          // start (ADC çš„è½¬æ¢ çš„æ§åˆ¶å™¨) è®¾ç½®ä¸ºé«˜ç”µå¹³ ï¼Œä¸Šå‡æ²¿ä½¿å…¶ é€æ­¥é€¼è¿‘å¯„å­˜å™¨ å¤ä
             -½   
 121   1          // åŒæ—¶è¢«å¼€å¯çš„è¿˜æœ‰ ALE(åœ°å€é”å­˜å™¨) ,ALE çš„æ—¶åºä¸ start æ˜¯å®Œå…¨åŒæ­¥çš„æ‰€ä»¥ ALE 
             -ä¸start è¿æ¥åŒä¸€ä¸ªæ¥å£
 122   1          //  è¾“å…¥3ä½åœ°å€ï¼Œ å¹¶ä½¿ALE = 1 ï¼Œå°†åœ°å€å­˜å…¥åœ°å€é”å­˜å™¨ä¸­ï¼Œç»è¿‡ åœ°å€è¯‘ç å™¨è¯‘
             -ç  8è·¯é€šé“ä¸­é€‰é€šä¸€è·¯æ¨¡æ‹Ÿé‡é€åˆ°æ¯”è¾ƒå™¨
 123   1          start = 1;
 124   1          // ç»è¿‡ä¸€æ®µæ—¶é—´å»¶æ—¶
 125   1          delay(1000);
 126   1          // å°†start = 1ï¼Œ ä¸‹é™æ²¿å¯åŠ¨ ADCçš„è½¬æ¢ï¼Œå¹¶ä¸”æ˜¯EOCçš„ä¿¡å·ä¸ºä½ç”µå¹³
 127   1          start = 0;
 128   1          // è½¬æ¢ç»“æŸçš„æ—¶å€™ï¼Œè½¬æ¢çš„ç»“æœé€åˆ°ä¸‰æ€è¾“å‡º é”å­˜å™¨ å¹¶ä½¿EOCä¿¡å·ä¼šå¸¦é«˜ç”µå¹³ï
             -¼Œ é€šçŸ¥CPU å·²ç»è½¬æ¢ç»“æŸ
 129   1          // ä½¿ç”¨ å¾ªç¯æ£€æµ‹ eoc ä¸º 1 çš„æƒ…å†µï¼Œ å½“eoc ==1çš„æƒ…å†µä¸‹ï¼Œè½¬æ¢å®Œæˆ 
 130   1          // while ä¼šåœ¨ eoc==1çš„æ—¶å€™è·³å‡ºå¾ªç¯
 131   1          while (eoc != 1);
 132   1          // å½“CPUæ‰§è¡Œä¸€è¯»æ•°æ®æŒ‡ä»¤ï¼Œ ä½¿ oeä¸ºé«˜ç”µå¹³ï¼Œåˆ™è¾“å‡ºç«¯ D0 -D7 è¾“å‡ºæ•°æ®
 133   1          // æ‰“å¼€ oe
 134   1          oe = 1;
 135   1          // vol ä» P2 ä¸­è¯»å–æ•°æ®
 136   1          vol = P2;
 137   1          // è¯»å–å®Œæˆ å å…³æ‰OE
 138   1          oe = 0;
 139   1      }
 140          
 141          void main(){
 142   1          // lcd åˆå§‹åŒ–
 143   1          initLcd();
 144   1          while (1)
 145   1          {
 146   2              // adc
 147   2              adc();
 148   2              display();
 149   2          }
 150   1          
 151   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    289    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     27    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
